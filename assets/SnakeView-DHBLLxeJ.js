var b=Object.defineProperty;var k=s=>{throw TypeError(s)};var T=(s,t,i)=>t in s?b(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i;var n=(s,t,i)=>T(s,typeof t!="symbol"?t+"":t,i),v=(s,t,i)=>t.has(s)||k("Cannot "+i);var w=(s,t,i)=>(v(s,t,"read from private field"),i?i.call(s):t.get(s)),R=(s,t,i)=>t.has(s)?k("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,i),g=(s,t,i,o)=>(v(s,t,"write to private field"),o?o.call(s,i):t.set(s,i),i);import{d as Q,c as _,F as I,a as f,o as A,b as M,H as U}from"./index-BanlswF8.js";class h{constructor(t,i){n(this,"x");n(this,"y");this.x=t,this.y=i}}const x=32,l=20,C=1e3/10,V=Q({__name:"SnakeGame",setup(s){var u;const t=x*l,i=x*l,d=class d{constructor(){n(this,"canvas");n(this,"context");this.canvas=document.getElementById("game-canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=t,this.canvas.height=i}DrawTile(e,c){this.context.fillStyle=c,this.context.fillRect(e.x*x,e.y*x,x,x)}DrawRect(e,c,y="white"){this.context.fillStyle=y,this.context.fillRect(e.x,e.y,c.x,c.y)}DrawImage(e,c,y){this.context.fillStyle="white",this.context.drawImage(c,e.x,e.y,y.x,y.y)}DrawText(e,c,y="white",D=16){this.context.fillStyle=y,this.context.font=`${D}px sans-serif`,this.context.fillText(c,e.x,e.y)}Clear(){this.context.clearRect(0,0,t,i)}static get instance(){return w(d,u)||g(d,u,new d),w(d,u)}};u=new WeakMap,R(d,u);let o=d;class m{constructor(){n(this,"body");n(this,"head");n(this,"score");n(this,"length");n(this,"direction");n(this,"moveQueue");const e=Math.floor(l/2);this.head=new h(e,e),this.body=new Array(new h(e-1,e),new h(e-2,e)),this.moveQueue=new Array,this.direction=new h(1,0),this.score=0,this.length=2}Update(){if(this.moveQueue.length>0){const e=this.moveQueue[0];e.x!=0&&this.direction.x!=0||e.y!=0&&this.direction.y!=0||(this.direction=e),this.moveQueue.shift()}this.body.unshift(new h(this.head.x,this.head.y)),this.head.x+=this.direction.x,this.head.y+=this.direction.y,this.body.length>this.score+2&&this.body.pop(),this.body.forEach(e=>{e.x==this.head.x&&e.y==this.head.y&&r.GameReset()}),(this.head.x<0||this.head.x>l-1||this.head.y<0||this.head.y>l-1)&&r.GameReset()}Render(){o.instance.DrawTile(this.head,"lime"),this.body.forEach(e=>{o.instance.DrawTile(e,"green")})}QueueMove(e){this.moveQueue.length>=2&&this.moveQueue.unshift(),this.moveQueue.push(e)}}class p{constructor(e){n(this,"snake");n(this,"position");this.snake=e,this.position=new h(0,0),this.RandPos()}Update(){this.snake.head.x==this.position.x&&this.snake.head.y==this.position.y&&(this.snake.score++,this.RandPos())}Render(){o.instance.DrawTile(this.position,"red")}RandPos(){if(this.position.x=Math.floor(Math.random()*l),this.position.y=Math.floor(Math.random()*l),this.snake.head.x==this.position.x&&this.snake.head.y==this.position.y){this.RandPos();return}this.snake.body.forEach(e=>{if(e.x==this.position.x&&e.y==this.position.y){this.RandPos();return}})}}class E{constructor(){n(this,"snake");n(this,"apple");n(this,"started",!1);this.snake=new m,this.apple=new p(this.snake)}GameReset(){this.snake=new m,this.apple=new p(this.snake),this.started=!1}Update(){this.started&&(this.snake.Update(),this.apple.Update())}Render(){o.instance.Clear(),o.instance.DrawRect(new h(0,0),new h(t,i),"grey"),this.snake.Render(),this.apple.Render(),o.instance.DrawText(new h(0,20),`Score: ${this.snake.score}`,"white",20)}QueueMove(e){e.x==-1&&!this.started||(this.snake.QueueMove(e),this.started=!0)}}const r=new E;document.addEventListener("keydown",a=>{a.repeat||((a.key=="w"||a.key=="ArrowUp")&&r.QueueMove(new h(0,-1)),(a.key=="a"||a.key=="ArrowLeft")&&r.QueueMove(new h(-1,0)),(a.key=="s"||a.key=="ArrowDown")&&r.QueueMove(new h(0,1)),(a.key=="d"||a.key=="ArrowRight")&&r.QueueMove(new h(1,0)))});function S(){r.Update(),r.Render()}return setInterval(S,C),(a,e)=>(A(),_(I,null,[e[0]||(e[0]=f("header",null,null,-1)),e[1]||(e[1]=f("main",null,[f("div",{id:"game-div"},[f("canvas",{id:"game-canvas"})])],-1))],64))}}),B={id:"game-div"},L=Q({__name:"SnakeView",setup(s){return(t,i)=>(A(),_("main",null,[M(U),f("div",B,[M(V)])]))}});export{L as default};
