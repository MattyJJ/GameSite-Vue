var T=Object.defineProperty;var w=s=>{throw TypeError(s)};var D=(s,t,i)=>t in s?T(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i;var n=(s,t,i)=>D(s,typeof t!="symbol"?t+"":t,i),k=(s,t,i)=>t.has(s)||w("Cannot "+i);var p=(s,t,i)=>(k(s,t,"read from private field"),i?i.call(s):t.get(s)),v=(s,t,i)=>t.has(s)?w("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,i),R=(s,t,i,h)=>(k(s,t,"write to private field"),h?h.call(s,i):t.set(s,i),i);import{d as M,c as Q,F as U,a as y,o as _,b as g,H as C}from"./index-CpAA07oL.js";class o{constructor(t,i){n(this,"x");n(this,"y");this.x=t,this.y=i}}const l=32,d=20,I=1e3/10,V=M({__name:"SnakeGame",setup(s){var u;const t=l*d,i=l*d,c=class c{constructor(){n(this,"canvas");n(this,"context");this.canvas=document.getElementById("game-canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=t,this.canvas.height=i}DrawTile(e,f){this.context.fillStyle=f,this.context.fillRect(e.x*l,e.y*l,l-5,l-5)}DrawText(e,f,S="white",b=16){this.context.fillStyle=S,this.context.font=`${b}px sans-serif`,this.context.fillText(f,e.x,e.y)}Clear(){this.context.clearRect(0,0,t,i)}static get instance(){return p(c,u)||R(c,u,new c),p(c,u)}};u=new WeakMap,v(c,u);let h=c;class x{constructor(){n(this,"body");n(this,"head");n(this,"score");n(this,"length");n(this,"direction");n(this,"moveQueue");const e=Math.floor(d/2);this.head=new o(e,e),this.body=new Array(new o(e-1,e),new o(e-2,e)),this.moveQueue=new Array,this.direction=new o(1,0),this.score=0,this.length=2}Update(){if(this.moveQueue.length>0){const e=this.moveQueue[0];e.x!=0&&this.direction.x!=0||e.y!=0&&this.direction.y!=0||(this.direction=e),this.moveQueue.shift()}this.body.unshift(new o(this.head.x,this.head.y)),this.head.x+=this.direction.x,this.head.y+=this.direction.y,this.body.length>this.score+2&&this.body.pop(),this.body.forEach(e=>{e.x==this.head.x&&e.y==this.head.y&&r.GameReset()}),(this.head.x<0||this.head.x>d-1||this.head.y<0||this.head.y>d-1)&&r.GameReset()}Render(){h.instance.DrawTile(this.head,"lime"),this.body.forEach(e=>{h.instance.DrawTile(e,"green")})}QueueMove(e){this.moveQueue.length>=2&&this.moveQueue.unshift(),this.moveQueue.push(e)}}class m{constructor(e){n(this,"snake");n(this,"position");this.snake=e,this.position=new o(0,0),this.RandPos()}Update(){this.snake.head.x==this.position.x&&this.snake.head.y==this.position.y&&(this.snake.score++,this.RandPos())}Render(){h.instance.DrawTile(this.position,"red")}RandPos(){if(this.position.x=Math.floor(Math.random()*d),this.position.y=Math.floor(Math.random()*d),this.snake.head.x==this.position.x&&this.snake.head.y==this.position.y){this.RandPos();return}this.snake.body.forEach(e=>{if(e.x==this.position.x&&e.y==this.position.y){this.RandPos();return}})}}class A{constructor(){n(this,"snake");n(this,"apple");n(this,"started",!1);this.snake=new x,this.apple=new m(this.snake)}GameReset(){this.snake=new x,this.apple=new m(this.snake),this.started=!1}Update(){this.started&&(this.snake.Update(),this.apple.Update())}Render(){h.instance.Clear(),this.snake.Render(),this.apple.Render(),h.instance.DrawText(new o(0,20),`Score: ${this.snake.score}`,"white",20)}QueueMove(e){e.x==-1&&!this.started||(this.snake.QueueMove(e),this.started=!0)}}const r=new A;document.addEventListener("keydown",a=>{a.repeat||((a.key=="w"||a.key=="ArrowUp")&&r.QueueMove(new o(0,-1)),(a.key=="a"||a.key=="ArrowLeft")&&r.QueueMove(new o(-1,0)),(a.key=="s"||a.key=="ArrowDown")&&r.QueueMove(new o(0,1)),(a.key=="d"||a.key=="ArrowRight")&&r.QueueMove(new o(1,0)))});function E(){r.Update(),r.Render()}return setInterval(E,I),(a,e)=>(_(),Q(U,null,[e[0]||(e[0]=y("header",null,null,-1)),e[1]||(e[1]=y("main",null,[y("canvas",{id:"game-canvas"})],-1))],64))}}),B={id:"game-div"},L=M({__name:"SnakeView",setup(s){return(t,i)=>(_(),Q("main",null,[g(C),y("div",B,[g(V)])]))}});export{L as default};
