var b=Object.defineProperty;var w=s=>{throw TypeError(s)};var S=(s,t,i)=>t in s?b(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i;var n=(s,t,i)=>S(s,typeof t!="symbol"?t+"":t,i),k=(s,t,i)=>t.has(s)||w("Cannot "+i);var y=(s,t,i)=>(k(s,t,"read from private field"),i?i.call(s):t.get(s)),x=(s,t,i)=>t.has(s)?w("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,i),v=(s,t,i,h)=>(k(s,t,"write to private field"),h?h.call(s,i):t.set(s,i),i);import{d as g,c as M,F as U,a as p,o as Q,b as R,H as C}from"./index-Big4zaRn.js";class o{constructor(t,i){n(this,"x");n(this,"y");this.x=t,this.y=i}}const l=32,c=20,I=1e3/10,T=g({__name:"SnakeGame",setup(s){var u;const t=l*c,i=l*c,d=class d{constructor(){n(this,"canvas");n(this,"context");this.canvas=document.getElementById("game-canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=t,this.canvas.height=i}DrawTile(e,E){this.context.fillStyle=E,this.context.fillRect(e.x*l,e.y*l,l-5,l-5)}Clear(){this.context.clearRect(0,0,t,i)}static get instance(){return y(d,u)||v(d,u,new d),y(d,u)}};u=new WeakMap,x(d,u);let h=d;class f{constructor(){n(this,"body");n(this,"head");n(this,"score");n(this,"length");n(this,"direction");n(this,"moveQueue");const e=Math.floor(c/2);this.head=new o(e,e),this.body=new Array(new o(e-1,e),new o(e-2,e)),this.moveQueue=new Array,this.direction=new o(1,0),this.score=0,this.length=2}Update(){if(this.moveQueue.length>0){const e=this.moveQueue[0];e.x!=0&&this.direction.x!=0||e.y!=0&&this.direction.y!=0||(this.direction=e),this.moveQueue.shift()}this.body.unshift(new o(this.head.x,this.head.y)),this.head.x+=this.direction.x,this.head.y+=this.direction.y,this.body.length>this.score+2&&this.body.pop(),this.body.forEach(e=>{e.x==this.head.x&&e.y==this.head.y&&r.GameReset()}),(this.head.x<0||this.head.x>c-1||this.head.y<0||this.head.y>c-1)&&r.GameReset()}Render(){h.instance.DrawTile(this.head,"lime"),this.body.forEach(e=>{h.instance.DrawTile(e,"green")})}QueueMove(e){this.moveQueue.length>=2&&this.moveQueue.unshift(),this.moveQueue.push(e)}}class m{constructor(e){n(this,"snake");n(this,"position");this.snake=e,this.position=new o(0,0),this.RandPos()}Update(){this.snake.head.x==this.position.x&&this.snake.head.y==this.position.y&&(this.snake.score++,this.RandPos())}Render(){h.instance.DrawTile(this.position,"red")}RandPos(){if(this.position.x=Math.floor(Math.random()*c),this.position.y=Math.floor(Math.random()*c),this.snake.head.x==this.position.x&&this.snake.head.y==this.position.y){this.RandPos();return}this.snake.body.forEach(e=>{if(e.x==this.position.x&&e.y==this.position.y){this.RandPos();return}})}}class _{constructor(){n(this,"snake");n(this,"apple");n(this,"started",!1);this.snake=new f,this.apple=new m(this.snake)}GameReset(){this.snake=new f,this.apple=new m(this.snake),this.started=!1}Update(){this.started&&(this.snake.Update(),this.apple.Update())}Render(){h.instance.Clear(),this.snake.Render(),this.apple.Render()}QueueMove(e){e.x==-1&&!this.started||(this.snake.QueueMove(e),this.started=!0)}}const r=new _;document.addEventListener("keydown",a=>{a.repeat||((a.key=="w"||a.key=="ArrowUp")&&r.QueueMove(new o(0,-1)),(a.key=="a"||a.key=="ArrowLeft")&&r.QueueMove(new o(-1,0)),(a.key=="s"||a.key=="ArrowDown")&&r.QueueMove(new o(0,1)),(a.key=="d"||a.key=="ArrowRight")&&r.QueueMove(new o(1,0)))});function A(){r.Update(),r.Render()}return setInterval(A,I),(a,e)=>(Q(),M(U,null,[e[0]||(e[0]=p("header",null,null,-1)),e[1]||(e[1]=p("main",null,[p("canvas",{id:"game-canvas"})],-1))],64))}}),V={id:"game-div"},G=g({__name:"SnakeView",setup(s){return(t,i)=>(Q(),M("main",null,[R(C),p("div",V,[R(T)])]))}});export{G as default};
